# -*- coding: utf-8 -*-
"""class119.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1EkGFMzv5DbDkLQWmE0-J8t8cGUDMgiTC
"""

import csv
import pandas as pd

col_name=['Pregnant','Glucose','BP','Skin','Insulin','BMI','Pedigree','age','label']
df=pd.read_csv('class119.csv',names=col_name).iloc[1:]

df.head()

features=['Pregnant','Glucose','BP','Insulin','BMI','Pedigree','age']

X=df[features]
y=df.label

from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split
from sklearn import metrics

X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=1)

clf=DecisionTreeClassifier()
clf=clf.fit(X_train,y_train)

y_pred=clf.predict(X_test)

print('Accuracy : ',metrics.accuracy_score(y_test,y_pred))

from sklearn.tree import export_graphviz
from sklearn.externals.six import StringIO
from IPython.display import Image
import pydotplus

dot_data=StringIO()

export_graphviz(clf,out_file=dot_data,filled=True,rounded=True,special_characters=True,
                feature_names=features,class_names=['0','1'])

#print(dot_data.getvalue())

import pydotplus

graph=pydotplus.graph_from_dot_data(dot_data.getvalue())
graph.write_png('Diabetes.png')
Image(graph.create_png())

clf=DecisionTreeClassifier(max_depth=3)
clf=clf.fit(X_train,y_train)

y_pred=clf.predict(X_test)

print('Accuracy : ',metrics.accuracy_score(y_test,y_pred))

from sklearn.tree import export_graphviz
from sklearn.externals.six import StringIO
from IPython.display import Image
import pydotplus

dot_data=StringIO()

export_graphviz(clf,out_file=dot_data,filled=True,rounded=True,special_characters=True,
                feature_names=features,class_names=['0','1'])

#print(dot_data.getvalue())
import pydotplus

graph=pydotplus.graph_from_dot_data(dot_data.getvalue())
graph.write_png('Diabetes.png')
Image(graph.create_png())

"""People who have glucose greater than 129.5 and BMI greater than 27.85 are more prone to be a diabetic patient."""